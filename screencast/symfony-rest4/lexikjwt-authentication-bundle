<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
            <script src="https://cdn.optimizely.com/js/421270022.js"></script>
    
                    <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>LexikJWTAuthenticationBundle > Symfony RESTful API: Authentication with JWT (Course 4) | KnpUniversity</title>

                    <link href="../../builds/main-db6835bf19d99bcc09032789f3bd39e4.css" rel="stylesheet">

        <link href='https://fonts.googleapis.com/css?family=Rokkitt' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Cedarville+Cursive' rel='stylesheet' type='text/css'>
    

    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/tomorrow-night.min.css">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/tomorrow-night.min.css">


        <link rel="stylesheet" href="../../builds/code_block_styles-2d783e385d9dbb1ef88d9053d1b8d675.css">



    <link href="../../builds/video-6b5fa6dfb768239b226d39d08bd4867e.css" rel="stylesheet">

                        <script src="../../bundles/fosjsrouting/js/router.js"></script>

        <script src="../../builds/main-1dfa89b76a105f9c2d98.js"></script>
        <script src="../../js/routing?callback=fos.Router.setData"></script>
            

    <script>
        // video settings
        window.video = {
            isCourseChapterPaid: false,
            courseChapterId: 39611
        };

                window.video.nextDetails = {
            'type': 'video',
            'title': 'Up Next: The\x20\x22Fetch\x20a\x20Token\x22\x20Endpoint\x20Test <i class="fa fa-play"></i>',
            'url': '/screencast/symfony-rest4/token-test#play'
        };
            </script>

    <script src="../../builds/video-1dfa89b76a105f9c2d98.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(function() {
            var hashValue = window.location.hash.substr(1);
            if (hashValue.substr(0, 7) == 'comment') {
                // this is a #comment link - open up the comment tab!
                $('.nav-tabs a[href="#tab-comment"]').click();
            }
        });
    </script>

    <link rel="alternate" type="application/rss+xml" title="Blog feed with technical articles around PHP and screencast and tutorial updates from KnpUniversity.com" href="http://feeds.feedburner.com/knpuniversity" />

    <meta name="description" content="After 3 tutorials, we&#039;ve got a nice API, But we&#039;ve been completely ignoring
authentication. Thanks to some modern tools, this will be *such* a treat:

* Understanding JSON web tokens (JWT)
* Creating, signing &amp; returning JWT&#039;s
* Using Guard for a custom JWT authentication system
* Sending tokens on the Authorization header
* Proper API errors for invalid credentials and missing credentials
* Choosing to split into 2 firewalls
">

    <meta property="og:site_name" content="KnpUniversity - PHP and Symfony Video Tutorial Screencasts">
    <meta name="twitter:site" content="@KnpUniversity"><link rel="shortcut icon" href="../../assets/images/favicon.ico">
    <link rel="icon" type="image/png" href="../../assets/images/favicon.png">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->    <meta property="og:title" content="LexikJWTAuthenticationBundle">
<meta property="og:description" content="After 3 tutorials, we&amp;#039;ve got a nice API, But we&amp;#039;ve been completely ignoring
authentication. Thanks to some modern tools, this will be *such* a treat:

* Understanding JSON web tokens (JWT)
* Creating, signing &amp;amp; returning JWT&amp;#039;s
* Using Guard for a custom JWT authentication system
* Sending tokens on the Authorization header
* Proper API errors for invalid credentials and missing credentials
* Choosing to split into 2 firewalls
">
<meta property="og:url" content="http://knpuniversity.com/screencast/symfony-rest4/lexikjwt-authentication-bundle">
    <meta property="og:image" content="http://knpuniversity.com/imagine/course_video_poster_large/uploads/screencast/symfony-rest4:a02aa0586187260128f0fe96d5d73ee470f3684c/rest-sf-4.png">

<meta name="twitter:card" content="summary">


                            
    </head>
<body data-user-id="" >
<nav class="navbar navbar-inverse nav-margin navbar-learning-layout">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle toggle-button collapsed" data-toggle="collapse" data-target="#js-navbar" aria-expanded="false" aria-controls="js-navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="../../logout" class="navbar-brand">
                <span class="knp-color-blue">Knp</span>
                <span class="knp-color-white">University</span>
            </a>
        </div>
        <form class="navbar-form navbar-left navbar-form-border" role="search" method="GET" action="http://knpuniversity.com/search">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Search Tutorials" value="" name="q">

                <div class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </div>
        </form>
        <div id="js-navbar" class="collapse-fix collapse navbar-right navbar-collapse">
            

<ul class="nav navbar-nav nav-narrowerOnSmall">
            <li><a href="../../checkout/subscription/team_yearly/5" title="Cart"><i class="fa fa-shopping-cart"></i></a></li>
        <li class="dropdown"><a href="lexikjwt-authentication-bundle#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tutorials <i class="fa fa-angle-down"></i></a>
        <ul class="dropdown-menu">
          <li><a href="../../tracks.1">Tracks</a></li>
          <li><a href="../../courses/all">All Courses</a></li>
        </ul>
    </li>
            <li><a href="../../pricing.1">Pricing</a></li>
        <li><a href="../../training">Training</a></li>
                <li class="visible-xs"><a href="../../logout">My Profile</a></li>
        <li class="visible-xs"><a href="../../logout">Sign Out</a></li>

            <li><a href="../../login.1">Log In</a></li>
        <li class="btn btn-sm btn-warning signup-btn"><a class="signup" href="../../signup/index.html">Sign Up</a></li>
    </ul>

        </div>
    </div>
</nav>


    




<div class="table-contents-container">
  <div class="container expandList" id="js-chapter-list">
      <button class="table-contents-container-button js-expand-list" data-target="js-chapter-list" title="Chapter List">
          <i class="fa fa-bars"></i>
                        3.
                            LexikJWTAuthenticationBundle
                </button>
      <div class="expandList-body">
          <div class="expandList-bodyInner">
              <h3 class="expandList-header">
                  <a class="course-title-expand" href="resume">Symfony RESTful API: Authentication with JWT (Course 4)</a>
              </h3>

                                <div class="watched-tut-progress-container watched-tut-progress-container-overview">
        <div class="watched-tut-progress-overview" style="width: 0%; margin-right: 100%;" title="0% complete"><span class="profile-progress-title">0%</span></div>
    </div>


              
              <div class="expand-chapter-list">
                      
    
    <!-- Table of contents -->
    <div class="chapter-list">
        <ul class="list-unstyled">
            
                
                                <li class="title chapter-list-item ">
            <a href="deny-access" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                1.
                        Start Securing the App!
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 4:20</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="json-web-token" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                2.
                        JSON Web Tokens (are awesome)
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 4:35</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item chapter-list-item-active">
            <a href="lexikjwt-authentication-bundle" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                3.
                        LexikJWTAuthenticationBundle
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 4:54</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="token-test" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                4.
                        The &quot;Fetch a Token&quot; Endpoint Test
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 4:09</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="create-json-web-token" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                5.
                        Create a Shiny JSON Web Token
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 4:53</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="send-token-in-request" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                6.
                        Authenticate a Request with JWT
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 2:18</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="jwt-guard-authenticator" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                7.
                        JWT Guard Authenticator (Part 1)
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 5:39</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="authenticator-comes-to-life" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                8.
                        Registering the Authenticator (Part 2)
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 2:12</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="always-require-auth" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                9.
                        Lock down: Require Authentication Everywhere
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 3:09</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="entry-point-multiple-firewalls" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                10.
                        The &quot;Entry Point&quot; &amp; Multiple Firewalls
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 4:16</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="auth-api-problem" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                11.
                        JSON Errors in your API
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 4:15</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="centralize-error-response" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                12.
                        ResponseFactory: Centralize Error Responses
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 3:36</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="handling-invalid-token" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                13.
                        Graceful Errors for an Invalid JWT
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 3:20</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="jwt-other-things" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                14.
                        JWT: Other Things to Think about
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 2:40</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


                    </ul>
    </div>

    
              </div>
          </div>
      </div>
  </div>
  <div>
                <a href="../../pricing/symfony-rest4" class="btn btn-success pull-right-md download-buy-buttons">Buy <span class="hidden-xs">Access to Course</span></a>
              </div>
</div>


        <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-9 col-lg-10">
                <h1 class="account-header account-header-low-margin-top">LexikJWTAuthenticationBundle</h1>
                
                                    <p class="hidden-xs">
                        Course:
                        <a class="knp-color-black" href="resume"><em>Symfony RESTful API: Authentication with JWT (Course 4) Tutorial</em></a>                    </p>
                            </div>
        </div>

                <div class="row">
            <div class="col-xs-12 col-md-10 col-md-offset-1">
                <div class="full-block-container">
                    <div class="frame-padding">
                        <div id="player">
                                                                                <div>
                                                                <div class="row">
                                    <div class="end-show">
                                        <div class="xs-col-12">
                                            <p class="end-show-header">Keep learning!</p>
                                        </div>
                                        <div class="col-xs-12">
                                            <p class="end-show-link"><a href="../../pricing.1" class="btn btn-success btn-md">Start your All Access Pass</a></p>
                                        </div>
                                        <div class="col-xs-12">
                                            <p class="end-show-link text-center"><a href="../buy/collections" class="knp-color-white">Buy just this tutorial for $10.00</a></p>
                                        </div>
                                    </div>
                                </div>
                                                            </div>
                                                </div>
                    </div>
                </div>
            </div>
        </div>
         
        <div class="row">
            <div class="col-xs-12 col-md-10 col-md-offset-1">
                <div class="pull-right">
                                    <a class="btn btn-success"
           href="token-test#play">
            Next Chapter <i class="fa fa-caret-right"></i>
        </a>
    
                </div>

                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a data-toggle="tab" href="lexikjwt-authentication-bundle#tab-script">Script</a></li>
                    <li><a data-toggle="tab" href="lexikjwt-authentication-bundle#tab-comment">
                        <i class="fa fa-comment-o"></i>
                                                    
                                                        Conversation
                                            </a></li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane active" id="tab-script">
                        <div class="js-script-content-wrapper top-margin-script markdown-content">
                                                                                        <a href="https://github.com/knpuniversity/symfony2-rest/edit/master/knpu/episode4/lexikjwt-authentication-bundle.md" target="_blank" class="btn btn-default btn-circle pull-right js-tooltip" title="Edit on GitHub"><span class="fa fa-pencil"></span></a>
                                                                    <p>Google for <code>LexikJWTAuthenticationBundle</code>. This bundle is going to make creating and
validating JSON web tokens as much fun as eating ice cream. Click to read the
documentation. And now, you guys know the drill. Copy the library name from the
<code>composer require</code> line and run:</p>
<pre><code class="language-bash"><div class="line">composer require lexik/jwt-authentication-bundle</div></code></pre>
<div class="admonition tip"><p class="admonition-title"><span class="fa fa-lightbulb-o"></span> Tip</p><p>Version 2 of this bundle is now out! Not much has changed, but we'll tell you
when something is different!</p>
</div><p>While we're waiting for Jordi, I mean Composer to download that for us, let's keep
busy. Copy the new bundle line and put that into <code>AppKernel</code>:</p>
<p><div class="code-block-wrapper" data-code-block-guid="331bd601b2">
    <div class="meta">
        <div class="actions">
            <span class="fa fa-clipboard js-activate-clipboard" data-toggle="tooltip" title="Copy Code" data-placement="top"></span>
        </div>
        <div class="info">
                        <span class="js-expand-all" data-range="1-53" data-toggle="tooltip" title="Show All Lines" data-placement="top">
                <i class="fa fa-expand js-icon-load-more"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </span>
            
            53 lines <span class="meta-divider"></span> <span title="app/AppKernel.php">app/AppKernel.php</span>
        </div>
    </div>
    <table class="hljs code-block-table">
        <tbody class="js-tr-container">
                <tr>
                    <td class="line-number line-number-expandable" data-range="1-5" data-last="0">
                <i class="fa fa-arrows-v js-icon-load-more" data-toggle="tooltip" title="Show Lines" data-placement="left"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </td>
            <td class="gap-line">
                                                    ... lines 1 - 5
                            </td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="6"></td>
            <td class="blob-code"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppKernel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Kernel</span></td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="7"></td>
            <td class="blob-code"></span>{</td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="8"></td>
            <td class="blob-code">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerBundles</span><span class="hljs-params">()</span></td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="9"></td>
            <td class="blob-code">    </span>{</td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="10"></td>
            <td class="blob-code">        $bundles = <span class="hljs-keyword">array</span>(</td>
            </tr>
    <tr>
                    <td class="line-number line-number-expandable" data-range="11-20" data-last="0">
                <i class="fa fa-arrows-v js-icon-load-more" data-toggle="tooltip" title="Show Lines" data-placement="left"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </td>
            <td class="gap-line">
                                                    ... lines 11 - 20
                            </td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="21"></td>
            <td class="blob-code">            <span class="hljs-keyword">new</span> Lexik\Bundle\JWTAuthenticationBundle\LexikJWTAuthenticationBundle(),</td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="22"></td>
            <td class="blob-code">        );</td>
            </tr>
    <tr>
                    <td class="line-number line-number-expandable" data-range="23-32" data-last="0">
                <i class="fa fa-arrows-v js-icon-load-more" data-toggle="tooltip" title="Show Lines" data-placement="left"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </td>
            <td class="gap-line">
                                                    ... lines 23 - 32
                            </td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="33"></td>
            <td class="blob-code">    }</td>
            </tr>
    <tr>
                    <td class="line-number line-number-expandable" data-range="34-51" data-last="0">
                <i class="fa fa-arrows-v js-icon-load-more" data-toggle="tooltip" title="Show Lines" data-placement="left"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </td>
            <td class="gap-line">
                                                    ... lines 34 - 51
                            </td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="52"></td>
            <td class="blob-code">}</td>
            </tr>

        </tbody>
    </table>
</div>
</p>
<p>Great!</p>
<h2 id="generating-the-public-and-private-key">Generating the Public and Private Key <a class="headerlink" href="lexikjwt-authentication-bundle#generating-the-public-and-private-key" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>Our first goal is to write some code that can take an array of information - like
a user's username - and turn that into a JSON web token. This bundle gives us a
really handy service to do that. </p>
<p>But before we can use it, we need to generate a public and private key. The private,
or secret key, will be used to <em>sign</em> the JSON web tokens. And no matter what the FBI
says, this must stay private: if someone else gets it, they'll be able to create
<em>new</em> JSON web tokens with whatever information they want - like with someone else's
username to gain access to their account. </p>
<p>Copy the first line, head to the terminal and wait for Composer to finish all its
thinking. Come on Jordi! Don't worry about the error: this bundle has some required
configuration that we're <em>about</em> to provide.</p>
<p>First, make a new directory to hold the keys:</p>
<pre><code class="language-bash"><div class="line">mkdir var/jwt</div></code></pre>
<p>Next, copy the second line to create a private key, but change its path to the
<code>var/jwt</code> directory:</p>
<pre><code class="language-bash"><div class="line">openssl genrsa -out var/jwt/private.pem -aes256 4096</div></code></pre>
<p>This asks you for a password - give it one! It adds another layer of security in case
somebody gets your private key. I'll use <code>happyapi</code>. Perfect!</p>
<p>Last step: copy the final line and remove <code>app</code> at the beginning and the end to point
to the <code>var/jwt</code> directory:</p>
<pre><code class="language-bash"><div class="line">openssl rsa -pubout -in var/jwt/private.pem -out var/jwt/public.pem</div></code></pre>
<p>Type in the password you just set. This creates a <em>public</em> key. It'll be used to
<em>verify</em> that a JWT hasn't been tampered with. It's not private, but you probably
won't need to share it, unless someone else - or some other app - needs to <em>also</em>
verify that a JWT we created is valid.</p>
<p>We now have a <code>private.pem</code> and a <code>public.pem</code>. You probably will <em>not</em> want to commit
these to your repository: the private key needs to stay secret. But there's good news!
You can create a key pair to use locally and then generate a totally different key
pair on production when you deploy. They don't need to be the same. Just don't change
the keys on production: that will invalidate any existing JSON web tokens that your
clients have.</p>
<h2 id="configuring-the-bundle">Configuring the Bundle <a class="headerlink" href="lexikjwt-authentication-bundle#configuring-the-bundle" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>Ok, last step: tell the bundle about our keys. Copy the configuration from the docs
and open up <code>app/config/config.yml</code>. Paste this at the bottom:</p>
<p><div class="code-block-wrapper" data-code-block-guid="da5ca87bc3">
    <div class="meta">
        <div class="actions">
            <span class="fa fa-clipboard js-activate-clipboard" data-toggle="tooltip" title="Copy Code" data-placement="top"></span>
        </div>
        <div class="info">
                        <span class="js-expand-all" data-range="1-77" data-toggle="tooltip" title="Show All Lines" data-placement="top">
                <i class="fa fa-expand js-icon-load-more"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </span>
            
            77 lines <span class="meta-divider"></span> <span title="app/config/config.yml">app/config/config.yml</span>
        </div>
    </div>
    <table class="hljs code-block-table">
        <tbody class="js-tr-container">
                <tr>
                    <td class="line-number line-number-expandable" data-range="1-72" data-last="0">
                <i class="fa fa-arrows-v js-icon-load-more" data-toggle="tooltip" title="Show Lines" data-placement="left"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </td>
            <td class="gap-line">
                                                    ... lines 1 - 72
                            </td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="73"></td>
            <td class="blob-code"><span class="hljs-attr">lexik_jwt_authentication:</span></td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="74"></td>
            <td class="blob-code"><span class="hljs-attr">    private_key_path:</span> %kernel.root_dir%/../var/jwt/private.pem</td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="75"></td>
            <td class="blob-code"><span class="hljs-attr">    public_key_path:</span>  %kernel.root_dir%/../var/jwt/public.pem</td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="76"></td>
            <td class="blob-code"><span class="hljs-attr">    pass_phrase:</span>      %jwt_key_pass_phrase%</td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="77"></td>
            <td class="blob-code"><span class="hljs-attr">    token_ttl:</span>        <span class="hljs-number">3600</span></td>
            </tr>

        </tbody>
    </table>
</div>
</p>
<p>Instead of using all these fancy parameters, it's fine to set the path directly:
<code>private_key_path: %kernel.root_dir%</code> - that's the <code>app/</code> directory - <code>/../var/jwt/private.pem</code>.
Do the same for the public key, with <code>public.pem</code>. Set the <code>token_ttl</code> to whatever
you want: I'll use 3600: this means every token will be valid for only 1 hour.</p>
<p>Finally, open <code>parameters.yml</code> and add the <code>jwt_key_pass_phrase</code>, which for me is
<code>happyapi</code>. Don't forget to add an empty setting also in <code>parameters.yml.dist</code>
for future developers:</p>
<p><div class="code-block-wrapper" data-code-block-guid="78111e8f4b">
    <div class="meta">
        <div class="actions">
            <span class="fa fa-clipboard js-activate-clipboard" data-toggle="tooltip" title="Copy Code" data-placement="top"></span>
        </div>
        <div class="info">
                        <span class="js-expand-all" data-range="1-22" data-toggle="tooltip" title="Show All Lines" data-placement="top">
                <i class="fa fa-expand js-icon-load-more"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </span>
            
            22 lines <span class="meta-divider"></span> <span title="app/config/parameters.yml.dist">app/config/parameters.yml.dist</span>
        </div>
    </div>
    <table class="hljs code-block-table">
        <tbody class="js-tr-container">
                <tr>
                    <td class="line-number line-number-expandable" data-range="1-1" data-last="0">
                <i class="fa fa-arrows-v js-icon-load-more" data-toggle="tooltip" title="Show Lines" data-placement="left"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </td>
            <td class="gap-line">
                                                    ... line 1
                            </td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="2"></td>
            <td class="blob-code"><span class="hljs-attr">parameters:</span></td>
            </tr>
    <tr>
                    <td class="line-number line-number-expandable" data-range="3-20" data-last="0">
                <i class="fa fa-arrows-v js-icon-load-more" data-toggle="tooltip" title="Show Lines" data-placement="left"></i>
                <i class="fa fa-spinner fa-spin js-icon-loading"></i>
            </td>
            <td class="gap-line">
                                                    ... lines 3 - 20
                            </td>
            </tr>
    <tr>
                    <td class="line-number line-number-displayed" data-line-number-displayed="21"></td>
            <td class="blob-code"><span class="hljs-attr">    jwt_key_pass_phrase:</span> ~</td>
            </tr>

        </tbody>
    </table>
</div>
</p>
<p>Phew! That's it! We had to generate a public and private key, but now, life is going
to be sweet. Run:</p>
<pre><code class="language-bash"><div class="line">bin/console debug:container jwt</div></code></pre>
<p>Select <code>lexik_jwt_authentication.jwt_encoder</code>. This is our new best friend for generating
JSON web tokens.</p>

    
                        </div>
                    </div>
                    <div class="tab-pane" id="tab-comment">
                        <h3>Leave a comment!</h3>
                                                        <div id="disqus_thread">
                <style type="text/css">
            #dsq-comments {padding: 10px 0 0}
            .dsq-comment {position: relative;clear: both;margin: 0 0 1.5em;}
            .dsq-avatar {left: 0;position: absolute;}
            .dsq-avatar img {border: 0 none;border-radius: 3px;height: 36px;width: 36px;}
            .dsq-comment-body {padding: 0 0 0 46px;}
            .dsq-comment-header {border: 1px solid rgba(0, 0, 0, 0.15);border-radius: 3px;font-size: 13px;line-height: 14px;margin: 0 0 1em;max-height: 36px;overflow: hidden;padding: 10px;position: relative;text-overflow: ellipsis;white-space: nowrap;}
            .dsq-comment-message {word-wrap: break-word;}
            .dsq-comment-message {line-height: 1.5em;margin: 0 0 1em;}
            .dsq-comment-text {display: inline;}
            .dsq-comment-date {float: right;font-size: 90%;margin: 0 12px 0 0;}
        </style>

	    <div id="dsq-content">
	        <ul id="dsq-comments">
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2962128242" id="dsq-comment-2962128242">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/disqus_SzOyeTPhoB/">
	                            	                                <img alt="" src="http://a.disquscdn.com/1479321018/images/noavatar92.png">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2962128242">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-10-21</span>
	                            <span class="dsq-commenter-name">John Armstrong</span>
	                        </div>

	                        <div id="dsq-comment-message-2962128242" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2962128242" class="dsq-comment-text">
	                                <p>That was me :)<br>Thanks for your help and awesome tutorials!</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2961929862" id="dsq-comment-2961929862">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/weaverryan/">
	                            	                                <img alt="" src="http://a.disquscdn.com/uploads/users/32/6480/avatar92.jpg?1482356913">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2961929862">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-10-21</span>
	                            <span class="dsq-commenter-name">weaverryan</span>
	                        </div>

	                        <div id="dsq-comment-message-2961929862" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2961929862" class="dsq-comment-text">
	                                <p>Hey John!</p><p>I was late on this - but it looks like Robin (bundle maintainer) already answered. For others: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Flexik%2FLexikJWTAuthenticationBundle%2Fissues%2F253%3AUTOjexdiQEYB8eSJksomiYHn8PU&amp;cuid=1175718" rel="nofollow noopener">https://github.com/lexik/Lexik...</a></p><p>Cheers!</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2959123051" id="dsq-comment-2959123051">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/disqus_SzOyeTPhoB/">
	                            	                                <img alt="" src="http://a.disquscdn.com/1479321018/images/noavatar92.png">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2959123051">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-10-19</span>
	                            <span class="dsq-commenter-name">John Armstrong</span>
	                        </div>

	                        <div id="dsq-comment-message-2959123051" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2959123051" class="dsq-comment-text">
	                                <p>Hello KNPU,</p><p>I'm trying to upload my symfony web/api app to Heroku, but it fails with this error:</p><p>Invalid configuration for path "lexik_jwt_authentication.private_key_path": The file "\/tmp\/build_a639bed6c50d79ea912b8fd3d5461615\/app\/..\/var\/jwt\/private.pem" doesn't exist or is not readable.<br>remote:          If the configured encoder doesn't need this to be configured, please don't set this option or leave it null.</p><p>Please help!</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2896384028" id="dsq-comment-2896384028">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/weaverryan/">
	                            	                                <img alt="" src="http://a.disquscdn.com/uploads/users/32/6480/avatar92.jpg?1482356913">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2896384028">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-09-15</span>
	                            <span class="dsq-commenter-name">weaverryan</span>
	                        </div>

	                        <div id="dsq-comment-message-2896384028" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2896384028" class="dsq-comment-text">
	                                <p>Hey Chuck!</p><p>Actually, it looks like you found a bug! I've just fixed it here: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fknpuniversity%2Fsymfony2-rest%2Fcommit%2F4e55471d8e940af6498ef8e3f79617d53518527a%3AxGRtyUlu3MJqsQwnq7OTGM11E6A&amp;cuid=1175718" rel="nofollow noopener">https://github.com/knpuniversi...</a></p><p>We use this bundle a little non-traditionally, choosing to build out parts of the security system ourselves, instead of letting the bundle do it for us. In fact, the token_ttl in config.yml is *never* used because we're creating the token ourselves. *We* need to manually set the expiration when creating the token.</p><p>Sorry about that oversight! But thanks for reporting it - I'll be adding a note to the text and video about it!</p><p>Thanks!</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2893327454" id="dsq-comment-2893327454">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/disqus_0Ksag17Pj1/">
	                            	                                <img alt="" src="http://a.disquscdn.com/1479321018/images/noavatar92.png">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2893327454">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-09-14</span>
	                            <span class="dsq-commenter-name">Chuck Norris</span>
	                        </div>

	                        <div id="dsq-comment-message-2893327454" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2893327454" class="dsq-comment-text">
	                                <p>Hi Ryan,</p><p>Just finished this awesome tutorial series.</p><p>But I still have some questions.<br>One of them is about the token_ttl. In my config, I set it to 3600, so, normally, the generated token is valid only for an hour.<br>But, if I create a token and I login with Postman or with a JS frontend (React in my case), I still can use the same Token even after a day.</p><p>With Postman, the token is directly written in the params header in every request,  and with react, the token is saved in localStorage.</p><p>Is it normal? Do I missed something ?</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	        </ul>
	    </div>
            </div>

    <script type="text/javascript">
    var disqus_shortname = 'knpuniversity';
    var disqus_container_id = 'disqus_thread';var disqus_developer = 1;var disqus_identifier = 'course_video_lexikjwt-authentication-bundle';var disqus_url = 'https://knpuniversity.com/screencast/symfony-rest4/lexikjwt-authentication-bundle';var disqus_config = function () {};

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

                                            </div>
                    <div class="pull-left-xs pull-right-md">
                                        <a class="btn btn-success"
           href="token-test#play">
            Next Chapter <i class="fa fa-caret-right"></i>
        </a>
    
                    </div>
                    <div class="pull-left addthis-module">
                        
    <div class="addthis_toolbox addthis_default_style js-analytics-addthis-wrapper addthis_32x32_style" addthis:url="http://knpuniversity.com/screencast/symfony-rest4/lexikjwt-authentication-bundle" addthis:title="Symfony RESTful API: Authentication with JWT (Course 4)">
        <a class="addthis_button_preferred_1"></a>
        <a class="addthis_button_preferred_2"></a>
        <a class="addthis_button_preferred_3"></a>
        <a class="addthis_button_preferred_4"></a>
        <a class="addthis_button_compact"></a>
        <a class="addthis_counter addthis_bubble_style"></a>
    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<footer class="footer footer-styling">
    <div class="container">
        <div class="row">
                        <div class="col-xs-7 col-sm-4">
                <div class="row">
                    <div class="col-xs-6">
                        <ul class="list-unstyled footer-link">
                            <li><a class="knp-color-black" href="../../courses/all">All Courses</a></li>
                                                            <li><a class="knp-color-black" href="../../pricing.1">Pricing</a></li>
                                                        <li><a class="knp-color-black" href="../../faq">FAQ</a></li>
                            <li><a class="knp-color-black" href="../../training">Training</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-6">
                        <ul class="list-unstyled footer-link">
                            <li><a class="knp-color-black" href="../../about">About</a></li>
                            <li><a class="knp-color-black" href="../../blog">Blog</a></li>
                            <li><a class="knp-color-black" href="../../contact">Contact Us</a></li>
                            <li>
                                <a class="knp-color-black" href="../../terms">Terms</a>
                                <span class="knp-color-black">&amp;</span>
                                <a class="knp-color-black" href="../../privacy">Privacy</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="hidden-xs col-sm-4">
                <p class="disclaimer">Symfony is a registered trademark of Fabien Potencier in the United States and/or other countries.
                This product is not endorsed or sponsored by Fabien Potencier.
                </p>
            </div>
            <div class="col-xs-5 col-sm-4">
                <div class="social-icons">
                    <a class="btn btn-social-icon btn-twitter" href="https://twitter.com/KnpUniversity">
                        <i class="fa fa-twitter"></i>
                    </a>
                    <a class="btn btn-social-icon btn-facebook" href="https://www.facebook.com/KnpLabs/">
                        <i class="fa fa-facebook"></i>
                    </a>
                    <a class="btn btn-social-icon btn-github" href="https://github.com/knpuniversity">
                        <i class="fa fa-github"></i>
                    </a>
                </div>
            </div>
                    </div>
    </div>
</footer>

<!-- JS -->
            <script>
        Core.analyticsVideoStatsUrl = '/api/analytics/video/duration';
    </script>

            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-7062980-20']);
        _gaq.push(['_trackPageview']);
    </script>
    <script>
    
    </script>
    
    <script type="text/javascript">
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
    
                <script type="text/javascript">
      (function() {
        var uv = document.createElement('script'); uv.type = 'text/javascript'; uv.async = true;
        uv.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'widget.uservoice.com/pOay2WLVabhXiEffbarO6Q.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uv, s);
      })();

      UserVoice = window.UserVoice || [];
      UserVoice.push(['showTab', 'classic_widget', {
          tab_position: 'bottom-right',
          tab_label: 'Ideas or Feedback?',
          tab_color: '#005E8E'
      }]);
    </script>
        
            
        <script type="text/javascript">
    var _sf_async_config={uid:54262,domain:"knpuniversity.com",useCanonical:true};
    (function(){
      function loadChartbeat() {
        window._sf_endpt=(new Date()).getTime();
        var e = document.createElement('script');
        e.setAttribute('language', 'javascript');
        e.setAttribute('type', 'text/javascript');
        e.setAttribute('src', '//static.chartbeat.com/js/chartbeat.js');
        document.body.appendChild(e);
      }
      var oldonload = window.onload;
      window.onload = (typeof window.onload != 'function') ?
         loadChartbeat : function() { oldonload(); loadChartbeat(); };
    })();
    </script>
    
            <script>
            (function(){
                var t,i,e,n=window,o=document,a=arguments,s="script",r=["config","track","identify","visit","push","call"],c=function(){var t,i=this;for(i._e=[],t=0;r.length>t;t++)(function(t){i[t]=function(){return i._e.push([t].concat(Array.prototype.slice.call(arguments,0))),i}})(r[t])};for(n._w=n._w||{},t=0;a.length>t;t++)n._w[a[t]]=n[a[t]]=n[a[t]]||new c;i=o.createElement(s),i.async=1,i.src="//static.woopra.com/js/w.js",e=o.getElementsByTagName(s)[0],e.parentNode.insertBefore(i,e)
            })("woopra");

            woopra.config({
                domain: 'knpuniversity.com',
                download_tracking: true,
                outgoing_tracking: true
            });

                            woopra.identify({
                    userType: 'anonymous',
                    hasSubscription: 'no'
                });
                    </script>

        <script>
            woopra.track(
            'course_view_chapter',
            {"course":"symfony-rest4","courseIsOwned":false,"chapter":"LexikJWTAuthenticationBundle","chapterNumber":3,"chapterIsFree":false}
        );
    </script>

        <script>
            woopra.track();
        </script>
     
        <script type="text/javascript">
    var _qevents = _qevents || [];

    (function() {
    var elem = document.createElement('script');
    elem.src = (document.location.protocol == "https:" ? "https://secure" : "http://edge") + ".quantserve.com/quant.js";
    elem.async = true;
    elem.type = "text/javascript";
    var scpt = document.getElementsByTagName('script')[0];
    scpt.parentNode.insertBefore(elem, scpt);
    })();

    _qevents.push({
    qacct:"p-8-SEHS37bhSQ0"
    });
    </script>

    <noscript>
    <div style="display:none;">
    <img src="http://pixel.quantserve.com/pixel/p-8-SEHS37bhSQ0.gif" border="0" height="1" width="1" alt="Quantcast"/>
    </div>
    </noscript>
    


    <script type="text/javascript" src="../../assets/vendor/jquery-sticky/jquery.sticky.js"></script>
    <script type="text/javascript" src="../../assets/vendor/zeroclipboard/dist/ZeroClipboard.min.js"></script>
    <script type="text/javascript" src="../../js/CodeBlocks.js"></script>
    <script type="text/javascript" src="../../bundles/knpuniversity/sphinx/js/underscore.js"></script>
    <script type="text/javascript" src="../../bundles/knpuniversity/sphinx/js/doctools.js"></script>

    <script>
        Core.courseTitle = 'Symfony RESTful API: Authentication with JWT (Course 4)';
        Core.courseId = 62
        Core.courseIsOwned = false;
        Core.courseSlug = 'symfony-rest4';
                    Core.chapterTitle = 'LexikJWTAuthenticationBundle';
            Core.chapterNumber = 3;
            Core.chapterIsFree = false;
            Core.chapterSlug = 'lexikjwt-authentication-bundle';
        
                var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../../',
            VERSION:     '1.0.0',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
        };

        jQuery(document).ready(function() {
            // Stick left sidebar menu
            $('.js-sticker').sticky();

            var $scriptWrapper = $('.js-script-content-wrapper');
            var codeBlocks = new Core.CodeBlocks($scriptWrapper);

            var expandList = $('.js-expand-list');

            expandList.on('click', function(){
                var target = $(this).data('target');
                var $expandArea = $('#' + target);
                $expandArea.toggleClass('expanded');

                // http://stackoverflow.com/questions/2868582/click-outside-menu-to-close-in-jquery
                $(document).one('click', function closeExpandList (e){
                    if($expandArea.has(e.target).length === 0){
                        $expandArea.removeClass('expanded');
                    } else {
                        $(document).one('click', closeExpandList);
                    }
                });
            });
        });
    </script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>



    <script type="text/javascript">
    var addthis_share = {
        templates: {
            twitter: '{{title}} - {{url}} | via @KnpUniversity'
        }
    }
</script>
<script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=weaverryan"></script>

</body>
</html>
