<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
            <script src="https://cdn.optimizely.com/js/421270022.js"></script>
    
                    <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"Vg4HUlBbGwAHVlFSDgM="};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o||e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,n){function r(t){try{c.console&&console.log(t)}catch(e){}}var o,i=t("ee"),a=t(12),c={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(c.console=!0,o.indexOf("dev")!==-1&&(c.dev=!0),o.indexOf("nr_dev")!==-1&&(c.nrDev=!0))}catch(s){}c.nrDev&&i.on("internal-error",function(t){r(t.stack)}),c.dev&&i.on("fn-err",function(t,e,n){r(n.stack)}),c.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(c,function(t,e){return t}).join(", ")))},{}],2:[function(t,e,n){function r(t,e,n,r,o){try{d?d-=1:i("err",[o||new UncaughtException(t,e,n)])}catch(c){try{i("ierr",[c,(new Date).getTime(),!0])}catch(s){}}return"function"==typeof f&&f.apply(this,a(arguments))}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function o(t){i("err",[t,(new Date).getTime()])}var i=t("handle"),a=t(13),c=t("ee"),s=t("loader"),f=window.onerror,u=!1,d=0;s.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(l){"stack"in l&&(t(5),t(4),"addEventListener"in window&&t(3),s.xhrWrappable&&t(6),u=!0)}c.on("fn-start",function(t,e,n){u&&(d+=1)}),c.on("fn-err",function(t,e,n){u&&(this.thrown=!0,o(n))}),c.on("fn-end",function(){u&&!this.thrown&&d>0&&(d-=1)}),c.on("internal-error",function(t){i("ierr",[t,(new Date).getTime(),!0])})},{}],3:[function(t,e,n){function r(t){for(var e=t;e&&!e.hasOwnProperty(u);)e=Object.getPrototypeOf(e);e&&o(e)}function o(t){c.inPlace(t,[u,d],"-",i)}function i(t,e){return t[1]}var a=t("ee").get("events"),c=t(14)(a,!0),s=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";e.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,e){var n=t[1],r=s(n,"nr@wrapped",function(){function t(){if("function"==typeof n.handleEvent)return n.handleEvent.apply(n,arguments)}var e={object:t,"function":n}[typeof n];return e?c(e,"fn-",null,e.name||"anonymous"):n});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],4:[function(t,e,n){var r=t("ee").get("raf"),o=t(14)(r),i="equestAnimationFrame";e.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],5:[function(t,e,n){function r(t,e,n){t[0]=a(t[0],"fn-",null,n)}function o(t,e,n){this.method=n,this.timerDuration="number"==typeof t[1]?t[1]:0,t[0]=a(t[0],"fn-",this,n)}var i=t("ee").get("timer"),a=t(14)(i),c="setTimeout",s="setInterval",f="clearTimeout",u="-start",d="-";e.exports=i,a.inPlace(window,[c,"setImmediate"],c+d),a.inPlace(window,[s],s+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(s+u,r),i.on(c+u,o)},{}],6:[function(t,e,n){function r(t,e){d.inPlace(e,["onreadystatechange"],"fn-",c)}function o(){var t=this,e=u.context(t);t.readyState>3&&!e.resolved&&(e.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,v,"fn-",c)}function i(t){y.push(t),h&&(w=-w,b.data=w)}function a(){for(var t=0;t<y.length;t++)r([],y[t]);y.length&&(y=[])}function c(t,e){return e}function s(t,e){for(var n in t)e[n]=t[n];return e}t(3);var f=t("ee"),u=f.get("xhr"),d=t(14)(u),l=NREUM.o,p=l.XHR,h=l.MO,m="readystatechange",v=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],y=[];e.exports=u;var g=window.XMLHttpRequest=function(t){var e=new p(t);try{u.emit("new-xhr",[e],e),e.addEventListener(m,o,!1)}catch(n){try{u.emit("internal-error",[n])}catch(r){}}return e};if(s(p,g),g.prototype=p.prototype,d.inPlace(g.prototype,["open","send"],"-xhr-",c),u.on("send-xhr-start",function(t,e){r(t,e),i(e)}),u.on("open-xhr-start",r),h){var w=1,b=document.createTextNode(w);new h(a).observe(b,{characterData:!0})}else f.on("fn-end",function(t){t[0]&&t[0].type===m||a()})},{}],7:[function(t,e,n){function r(t){var e=this.params,n=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!e.aborted){if(n.duration=(new Date).getTime()-this.startTime,4===t.readyState){e.status=t.status;var i=o(t,this.lastSize);if(i&&(n.rxSize=i),this.sameOrigin){var a=t.getResponseHeader("X-NewRelic-App-Data");a&&(e.cat=a.split(", ").pop())}}else e.status=0;n.cbTime=this.cbTime,f.emit("xhr-done",[t],t),c("xhr",[e,n,this.startTime])}}}function o(t,e){var n=t.responseType;if("json"===n&&null!==e)return e;var r="arraybuffer"===n||"blob"===n||"json"===n?t.response:t.responseText;return h(r)}function i(t,e){var n=s(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}var a=t("loader");if(a.xhrWrappable){var c=t("handle"),s=t(8),f=t("ee"),u=["load","error","abort","timeout"],d=u.length,l=t("id"),p=t(11),h=t(10),m=window.XMLHttpRequest;a.features.xhr=!0,t(6),f.on("new-xhr",function(t){var e=this;e.totalCbs=0,e.called=0,e.cbTime=0,e.end=r,e.ended=!1,e.xhrGuids={},e.lastSize=null,p&&(p>34||p<10)||window.opera||t.addEventListener("progress",function(t){e.lastSize=t.loaded},!1)}),f.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),f.on("send-xhr-start",function(t,e){var n=this.metrics,r=t[0],o=this;if(n&&r){var i=h(r);i&&(n.txSize=i)}this.startTime=(new Date).getTime(),this.listener=function(t){try{"abort"===t.type&&(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof e.onload))&&o.end(e)}catch(n){try{f.emit("internal-error",[n])}catch(r){}}};for(var a=0;a<d;a++)e.addEventListener(u[a],this.listener,!1)}),f.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),f.on("xhr-load-added",function(t,e){var n=""+l(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),f.on("xhr-load-removed",function(t,e){var n=""+l(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),f.on("addEventListener-end",function(t,e){e instanceof m&&"load"===t[0]&&f.emit("xhr-load-added",[t[1],t[2]],e)}),f.on("removeEventListener-end",function(t,e){e instanceof m&&"load"===t[0]&&f.emit("xhr-load-removed",[t[1],t[2]],e)}),f.on("fn-start",function(t,e,n){e instanceof m&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=(new Date).getTime()))}),f.on("fn-end",function(t,e){this.xhrCbStart&&f.emit("xhr-cb-time",[(new Date).getTime()-this.xhrCbStart,this.onload,e],e)})}},{}],8:[function(t,e,n){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!e.protocol||":"===e.protocol||e.protocol===n.protocol,a=e.hostname===document.domain&&e.port===n.port;return r.sameOrigin=i&&(!e.hostname||a),r}},{}],9:[function(t,e,n){function r(){}function o(t,e,n){return function(){return i(t,[(new Date).getTime()].concat(c(arguments)),e?null:this,n),e?void 0:this}}var i=t("handle"),a=t(12),c=t(13),s=t("ee").get("tracer"),f=NREUM;"undefined"==typeof window.newrelic&&(newrelic=f);var u=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit"],d="api-",l=d+"ixn-";a(u,function(t,e){f[e]=o(d+e,!0,"api")}),f.addPageAction=o(d+"addPageAction",!0),f.setCurrentRouteName=o(d+"routeName",!0),e.exports=newrelic,f.interaction=function(){return(new r).get()};var p=r.prototype={createTracer:function(t,e){var n={},r=this,o="function"==typeof e;return i(l+"tracer",[Date.now(),t,n],r),function(){if(s.emit((o?"":"no-")+"fn-start",[Date.now(),r,o],n),o)try{return e.apply(this,arguments)}finally{s.emit("fn-end",[Date.now()],n)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){p[e]=o(l+e)}),newrelic.noticeError=function(t){"string"==typeof t&&(t=new Error(t)),i("err",[t,(new Date).getTime()])}},{}],10:[function(t,e,n){e.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(e){return}}}},{}],11:[function(t,e,n){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),e.exports=r},{}],12:[function(t,e,n){function r(t,e){var n=[],r="",i=0;for(r in t)o.call(t,r)&&(n[i]=e(r,t[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;e.exports=r},{}],13:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(o<0?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=r},{}],14:[function(t,e,n){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(13),a="nr@original",c=Object.prototype.hasOwnProperty,s=!1;e.exports=function(t,e){function n(t,e,n,o){function nrWrapper(){var r,a,c,s;try{a=this,r=i(arguments),c="function"==typeof n?n(r,a):n||{}}catch(f){l([f,"",[r,a,o],c])}u(e+"start",[r,a,o],c);try{return s=t.apply(a,r)}catch(d){throw u(e+"err",[r,a,d],c),d}finally{u(e+"end",[r,a,s],c)}}return r(t)?t:(e||(e=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,e,o,i){o||(o="");var a,c,s,f="-"===o.charAt(0);for(s=0;s<e.length;s++)c=e[s],a=t[c],r(a)||(t[c]=n(a,f?c+o:o,i,c))}function u(n,r,o){if(!s||e){var i=s;s=!0;try{t.emit(n,r,o)}catch(a){l([a,n,r,o])}s=i}}function d(t,e){if(Object.defineProperty&&Object.keys)try{var n=Object.keys(t);return n.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(r){l([r])}for(var o in t)c.call(t,o)&&(e[o]=t[o]);return e}function l(e){try{t.emit("internal-error",e)}catch(n){}}return t||(t=o),n.inPlace=f,n.flag=a,n}},{}],ee:[function(t,e,n){function r(){}function o(t){function e(t){return t&&t instanceof r?t:t?s(t,c,i):i()}function n(n,r,o){if(!l.aborted){t&&t(n,r,o);for(var i=e(o),a=h(n),c=a.length,s=0;s<c;s++)a[s].apply(i,r);var f=u[g[n]];return f&&f.push([w,n,r,i]),i}}function p(t,e){y[t]=h(t).concat(e)}function h(t){return y[t]||[]}function m(t){return d[t]=d[t]||o(n)}function v(t,e){f(t,function(t,n){e=e||"feature",g[n]=e,e in u||(u[e]=[])})}var y={},g={},w={on:p,emit:n,get:m,listeners:h,context:e,buffer:v,abort:a,aborted:!1};return w}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var c="nr@context",s=t("gos"),f=t(12),u={},d={},l=e.exports=o();l.backlog=u},{}],gos:[function(t,e,n){function r(t,e,n){if(o.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[e]=r,r}var o=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){o.buffer([t],r),o.emit(t,e,n)}var o=t("ee").get("handle");e.exports=r,r.ee=o},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!b++){var t=w.info=NREUM.info,e=d.getElementsByTagName("script")[0];if(setTimeout(f.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return f.abort();s(y,function(e,n){t[e]||(t[e]=n)}),c("mark",["onload",a()],null,"api");var n=d.createElement("script");n.src="https://"+t.agent,e.parentNode.insertBefore(n,e)}}function o(){"complete"===d.readyState&&i()}function i(){c("mark",["domContent",a()],null,"api")}function a(){return(new Date).getTime()}var c=t("handle"),s=t(12),f=t("ee"),u=window,d=u.document,l="addEventListener",p="attachEvent",h=u.XMLHttpRequest,m=h&&h.prototype;NREUM.o={ST:setTimeout,CT:clearTimeout,XHR:h,REQ:u.Request,EV:u.Event,PR:u.Promise,MO:u.MutationObserver},t(9);var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-998.min.js"},g=h&&m&&m[l]&&!/CriOS/.test(navigator.userAgent),w=e.exports={offset:a(),origin:v,features:{},xhrWrappable:g};d[l]?(d[l]("DOMContentLoaded",i,!1),u[l]("load",r,!1)):(d[p]("onreadystatechange",o),u[p]("onload",r)),c("mark",["firstbyte",a()],null,"api");var b=0},{}]},{},["loader",2,7]);</script>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Authorization Code Grant Type > OAuth2 in 8 Steps | KnpUniversity</title>

                    <link href="../../builds/main-db6835bf19d99bcc09032789f3bd39e4.css" rel="stylesheet">

        <link href='https://fonts.googleapis.com/css?family=Rokkitt' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Cedarville+Cursive' rel='stylesheet' type='text/css'>
    

    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/tomorrow-night.min.css">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/tomorrow-night.min.css">


        <link rel="stylesheet" href="../../builds/code_block_styles-2d783e385d9dbb1ef88d9053d1b8d675.css">



    <link href="../../builds/video-6b5fa6dfb768239b226d39d08bd4867e.css" rel="stylesheet">

                        <script src="../../bundles/fosjsrouting/js/router.js"></script>

        <script src="../../builds/main-1dfa89b76a105f9c2d98.js"></script>
        <script src="../../js/routing?callback=fos.Router.setData"></script>
            

    <script>
        // video settings
        window.video = {
            isCourseChapterPaid: false,
            courseChapterId: 20779
        };

                window.video.nextDetails = {
            'type': 'video',
            'title': 'Up Next: Authorization\x20Code\x3A\x20Saving\x20the\x20Token\x20\x26\x20Handling\x20Failures <i class="fa fa-play"></i>',
            'url': '/screencast/oauth/authorization-code2#play'
        };
            </script>

    <script src="../../builds/video-1dfa89b76a105f9c2d98.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(function() {
            var hashValue = window.location.hash.substr(1);
            if (hashValue.substr(0, 7) == 'comment') {
                // this is a #comment link - open up the comment tab!
                $('.nav-tabs a[href="#tab-comment"]').click();
            }
        });
    </script>

    <link rel="alternate" type="application/rss+xml" title="Blog feed with technical articles around PHP and screencast and tutorial updates from KnpUniversity.com" href="http://feeds.feedburner.com/knpuniversity" />

    <meta name="description" content="OAuth2: that mystical beast that you kind of understand and occasionally
wrestle to integrate with some social media site.

Time to master OAuth2... and why not do it by building a real app with
farmers, chickens and real-life providers like Facebook and Google Plus.
We&#039;ll show you how OAuth really works while looking at how OAuth will
feel by using SDK&#039;s and other tools that give you shortcuts.

And like always, we&#039;ll go directly at the ugly details, like token expiration
and having a user deny access to your application. Here&#039;s what you&#039;ll
be learning:

* 3 main OAuth grant types: client credentials, authorization code and implicit;
* The exact flow behind getting your application authorized, exchanging
  an authorization code for a token, and using the token;
* Authentication (single sign-on) using OAuth;
* Handling expired tokens;
* Using refresh tokens;
* Integrating and authentication with Facebook;
* OAuth integration with Google+;
* What to look out for with security and how you can tighten things.
">

    <meta property="og:site_name" content="KnpUniversity - PHP and Symfony Video Tutorial Screencasts">
    <meta name="twitter:site" content="@KnpUniversity"><link rel="shortcut icon" href="../../assets/images/favicon.ico">
    <link rel="icon" type="image/png" href="../../assets/images/favicon.png">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->    <meta property="og:title" content="Authorization Code Grant Type">
<meta property="og:description" content="OAuth2: that mystical beast that you kind of understand and occasionally
wrestle to integrate with some social media site.

Time to master OAuth2">
<meta property="og:url" content="http://knpuniversity.com/screencast/oauth/authorization-code">
    <meta property="og:image" content="http://knpuniversity.com/imagine/course_video_poster_large/uploads/screencast/oauth:1e115c422acb5c00225bfbab187b202cb86a0cb7/oauth.png">

<meta name="twitter:card" content="summary">


                            
    </head>
<body data-user-id="" >
<nav class="navbar navbar-inverse nav-margin navbar-learning-layout">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle toggle-button collapsed" data-toggle="collapse" data-target="#js-navbar" aria-expanded="false" aria-controls="js-navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="../../logout" class="navbar-brand">
                <span class="knp-color-blue">Knp</span>
                <span class="knp-color-white">University</span>
            </a>
        </div>
        <form class="navbar-form navbar-left navbar-form-border" role="search" method="GET" action="http://knpuniversity.com/search">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="Search Tutorials" value="" name="q">

                <div class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </div>
        </form>
        <div id="js-navbar" class="collapse-fix collapse navbar-right navbar-collapse">
            

<ul class="nav navbar-nav nav-narrowerOnSmall">
            <li><a href="../../checkout/subscription/team_yearly/5" title="Cart"><i class="fa fa-shopping-cart"></i></a></li>
        <li class="dropdown"><a href="authorization-code#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tutorials <i class="fa fa-angle-down"></i></a>
        <ul class="dropdown-menu">
          <li><a href="../../tracks.1">Tracks</a></li>
          <li><a href="../../courses/all">All Courses</a></li>
        </ul>
    </li>
            <li><a href="../../pricing.1">Pricing</a></li>
        <li><a href="../../training">Training</a></li>
                <li class="visible-xs"><a href="../../logout">My Profile</a></li>
        <li class="visible-xs"><a href="../../logout">Sign Out</a></li>

            <li><a href="../../login.1">Log In</a></li>
        <li class="btn btn-sm btn-warning signup-btn"><a class="signup" href="../../signup/index.html">Sign Up</a></li>
    </ul>

        </div>
    </div>
</nav>


    




<div class="table-contents-container">
  <div class="container expandList" id="js-chapter-list">
      <button class="table-contents-container-button js-expand-list" data-target="js-chapter-list" title="Chapter List">
          <i class="fa fa-bars"></i>
                        3.
                            Authorization Code Grant Type
                </button>
      <div class="expandList-body">
          <div class="expandList-bodyInner">
              <h3 class="expandList-header">
                  <a class="course-title-expand" href="resume">OAuth2 in 8 Steps</a>
              </h3>

                                <div class="watched-tut-progress-container watched-tut-progress-container-overview">
        <div class="watched-tut-progress-overview" style="width: 0%; margin-right: 100%;" title="0% complete"><span class="profile-progress-title">0%</span></div>
    </div>


              
              <div class="expand-chapter-list">
                      
    
    <!-- Table of contents -->
    <div class="chapter-list">
        <ul class="list-unstyled">
            
                
                                <li class="title chapter-list-item ">
            <a href="intro" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                1.
                        Serious OAuth in 8 Steps
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 2:43</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="client-credentials" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                2.
                        Client Credentials
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 8:55</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item chapter-list-item-active">
            <a href="authorization-code" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                3.
                        Authorization Code Grant Type
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 10:22</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="authorization-code2" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                4.
                        Authorization Code: Saving the Token &amp; Handling Failures
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 10:37</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="logging-in" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                5.
                        User Login with OAuth
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 7:01</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="facebook" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                6.
                        OAuth with Facebook
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 11:28</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="facebook2" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                7.
                        Facebook: Using the API, Logging in and Failure
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 10:05</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="javascript-implicit-google-plus" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                8.
                        Implicit Grant Type with Google+
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 9:45</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="implicit2" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                9.
                        Finishing the Login Callback
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 5:03</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="refresh-token" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                10.
                        Using Refresh Tokens
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 7:08</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


            
                
                                <li class="title chapter-list-item ">
            <a href="security" class="">
                <div class="row">
                    <div class="col-xs-9">
                                                11.
                        Security
                                            </div>

                                    <div class="col-xs-3 text-right">
                        <span> 10:10</span>
                    </div>
                                </div>
            </a>
            <div class="row">
                <div class="col-xs-12">
                                    </div>
            </div>
        </li>


                    </ul>
    </div>

    
              </div>
          </div>
      </div>
  </div>
  <div>
                <a href="../../pricing/oauth" class="btn btn-success pull-right-md download-buy-buttons">Buy <span class="hidden-xs">Access to Course</span></a>
              </div>
</div>


        <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-9 col-lg-10">
                <h1 class="account-header account-header-low-margin-top">Authorization Code Grant Type</h1>
                
                                    <p class="hidden-xs">
                        Course:
                        <a class="knp-color-black" href="resume"><em>OAuth2 in 8 Steps Tutorial</em></a>                    </p>
                            </div>
        </div>

                <div class="row">
            <div class="col-xs-12 col-md-10 col-md-offset-1">
                <div class="full-block-container">
                    <div class="frame-padding">
                        <div id="player">
                                                                                <div>
                                                                <div class="row">
                                    <div class="end-show">
                                        <div class="xs-col-12">
                                            <p class="end-show-header">Keep learning!</p>
                                        </div>
                                        <div class="col-xs-12">
                                            <p class="end-show-link"><a href="../../pricing.1" class="btn btn-success btn-md">Start your All Access Pass</a></p>
                                        </div>
                                        <div class="col-xs-12">
                                            <p class="end-show-link text-center"><a href="../buy/collections" class="knp-color-white">Buy just this tutorial for $12.00</a></p>
                                        </div>
                                    </div>
                                </div>
                                                            </div>
                                                </div>
                    </div>
                </div>
            </div>
        </div>
         
        <div class="row">
            <div class="col-xs-12 col-md-10 col-md-offset-1">
                <div class="pull-right">
                                    <a class="btn btn-success"
           href="authorization-code2#play">
            Next Chapter <i class="fa fa-caret-right"></i>
        </a>
    
                </div>

                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a data-toggle="tab" href="authorization-code#tab-script">Script</a></li>
                    <li><a data-toggle="tab" href="authorization-code#tab-comment">
                        <i class="fa fa-comment-o"></i>
                                                    
                                                                                                (9)
                                                                                        Conversation
                                            </a></li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane active" id="tab-script">
                        <div class="js-script-content-wrapper top-margin-script script-content">
                                                                                        <a href="https://github.com/knpuniversity/oauth/edit/master/knpu/authorization-code.rst" target="_blank" class="btn btn-default btn-circle pull-right js-tooltip" title="Edit on GitHub"><span class="fa fa-pencil"></span></a>
                                                                    
  <div class="section" id="authorization-code-grant-type">
<h1>Authorization Code Grant Type<a class="headerlink" href="authorization-code#authorization-code-grant-type" title="Permalink to this headline">¶</a></h1>
<p>Suddenly, Brent is jolted awake at noon to the sound of farmer Scott driving
his eggs to the market and screaming &#8220;Haha, Brent! My chickens lay way more
eggs than yours!&#8221; But in reality, Brent <em>knows</em> that his chickens are way
better egg-making hens than Scott&#8217;s... but how to prove it?</p>
<p>Then it hits him! The COOP API has an endpoint to see how many eggs have
been collected from a user&#8217;s farm each day. Brent decides to create a new
website that will use this endpoint to count how many total eggs a COOP user&#8217;s
farm has collected. He&#8217;ll call it: Top Cluck! Fantasy Chicken League, or FCL for short.
To call the <tt class="docutils literal"><span class="pre">/api/eggs-count</span></tt> endpoint on behalf of each user, the site
will use OAuth to collect an access token for every farmer that signs up.</p>
<p>Once again, the question is: how can each user give FCL an access token that
allows it to count eggs on their behalf?</p>
<div class="section" id="starting-up-fcl">
<h2>Starting up FCL<a class="headerlink" href="authorization-code#starting-up-fcl" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s check out the FCL app, which Brent has already started building. It
lives in the  <tt class="docutils literal"><span class="pre">client/</span></tt> directory of the code download. I&#8217;ll use the built-in
PHP web server to run this site:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd </span>client/web
php -S localhost:9000
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Code along with us! Click the Download link on this page to get the starting
point of the project.</p>
</div>
<p>That command starts a built-in PHP webserver, and it&#8217;ll just sit right there
until we&#8217;re ready to turn it off. This project also uses Composer, so let&#8217;s
copy the <tt class="docutils literal"><span class="pre">composer.phar</span></tt> file we used earlier into this directory and use
install to download some outside libraries the project uses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If this doesn&#8217;t work and PHP simply shows you its command-line options,
check your PHP version. The built-in web server requires PHP 5.4 or higher.</p>
</div>
<p>Put the URL to the site into your browser and load it up. Welcome to Top Cluck!
We already have a leaderboard and basic registration. Go ahead and create an
account, which automatically logs us in.</p>
<p>The site is fully-functional, with database tables ready to keep track of
how many eggs each farmer has collected. The only missing piece is OAuth:
getting the access token for each user so that we can make an API request
to count their eggs.</p>
</div>
<div class="section" id="redirecting-to-authorize">
<h2>Redirecting to Authorize<a class="headerlink" href="authorization-code#redirecting-to-authorize" title="Permalink to this headline">¶</a></h2>
<p>Before TopCluck can make an API request to COOP to count my eggs, I need
to authorize it. On the homepage, there&#8217;s already an Authorize link, which
just prints a message right now.</p>
<p>The code behind this URL lives in the <tt class="docutils literal"><span class="pre">src/OAuth2Demo/Client/Controllers/CoopOAuthController.php</span></tt>
file. You don&#8217;t even need to understand how this works, just know that whatever
we do here, shows up:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/OAuth2Demo/Client/Controllers/CoopOAuthController.php</span>
<span class="c1">// ...</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">redirectToAuthorization</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Hallo world!&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The first step of the authorization code grant type is to redirect the user
to a specific URL on COOP. From here the user will authorize our app.
According to <a class="reference external" href="http://coop.apps.knpuniversity.com/api#authentication">COOP&#8217;s API Authentication page</a>, we need to redirect
the user to <tt class="docutils literal"><span class="pre">/authorize</span></tt> and send several query parameters.</p>
<p>In our code, let&#8217;s start building the URL:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/OAuth2Demo/Client/Controllers/CoopOAuthController.php</span>
<span class="c1">// ...</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">redirectToAuthorization</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$url</span> <span class="o">=</span> <span class="s1">&#39;http://coop.apps.knpuniversity.com/authorize?&#39;</span><span class="o">.</span><span class="nb">http_build_query</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;response_type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
        <span class="s1">&#39;client_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span>
        <span class="s1">&#39;redirect_uri&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span>
        <span class="s1">&#39;scope&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;eggs-count profile&#39;</span>
    <span class="p">));</span>

    <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span><span class="k">die</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">response_type</span></tt> type is <tt class="docutils literal"><span class="pre">code</span></tt> because we&#8217;re using the Authorization
Code flow. The other valid value is <tt class="docutils literal"><span class="pre">token</span></tt>, which is for a grant type
called implicit flow. We&#8217;ll see that later.</p>
<p>For <tt class="docutils literal"><span class="pre">scopes</span></tt>, we&#8217;re using <tt class="docutils literal"><span class="pre">profile</span></tt> and <tt class="docutils literal"><span class="pre">eggs-count</span></tt> so that once we&#8217;re
authorized, we can get some profile data about the COOP user and, of course,
count their eggs.</p>
<p>To get a <tt class="docutils literal"><span class="pre">client_id</span></tt>, let&#8217;s go to COOP and create a new application that
represents TopCluck. The most important thing is to check the 2 boxes for
profile information and collecting the egg count. I&#8217;ll show you why in a second.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If there is already an application with the name you want, just choose
something different and use that as your <tt class="docutils literal"><span class="pre">client_id</span></tt>.</p>
</div>
<p>Copy the <tt class="docutils literal"><span class="pre">client_id</span></tt> into our URL. Great! The last piece is the <tt class="docutils literal"><span class="pre">redirect_uri</span></tt>,
which is a URL on our site that COOP will send the user to after granting
or denying our application access. We&#8217;re going to do all kinds of important
things once that happens.</p>
<p>Let&#8217;s set that URL to be <tt class="docutils literal"><span class="pre">/coop/oauth/handle</span></tt>, which is just another page
that&#8217;s printing a message. The code for this is right inside the same file,
a little further down:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/OAuth2Demo/Client/Controllers/CoopOAuthController.php</span>
<span class="c1">// ...</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">receiveAuthorizationCode</span><span class="p">(</span><span class="nx">Application</span> <span class="nv">$app</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// equivalent to $_GET[&#39;code&#39;]</span>
    <span class="nv">$code</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">);</span>

    <span class="k">die</span><span class="p">(</span><span class="s1">&#39;Implement this in CoopOAuthController::receiveAuthorizationCode&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Instead of hardcoding the URL, I&#8217;ll use the URL generator that&#8217;s part of
Silex:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">redirectToAuthorization</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$redirectUrl</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateUrl</span><span class="p">(</span><span class="s1">&#39;coop_authorize_redirect&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="k">true</span><span class="p">);</span>

    <span class="nv">$url</span> <span class="o">=</span> <span class="s1">&#39;http://coop.apps.knpuniversity.com/authorize?&#39;</span><span class="o">.</span><span class="nb">http_build_query</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;response_type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
        <span class="s1">&#39;client_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;TopCluck&#39;</span><span class="p">,</span>
        <span class="s1">&#39;redirect_uri&#39;</span> <span class="o">=&gt;</span> <span class="nv">$redirectUrl</span><span class="p">,</span>
        <span class="s1">&#39;scope&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;eggs-count profile&#39;</span>
    <span class="p">));</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>However you make your URL, just make sure it&#8217;s absolute. Ok, we&#8217;ve built our
authorize URL to COOP, let&#8217;s redirect the user to it:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">redirectToAuthorization</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>That <tt class="docutils literal"><span class="pre">redirect</span></tt> function is special to my app, so your code may differ. As
long as you somehow redirect the user, you&#8217;re good.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Since we&#8217;re using Silex, the <tt class="docutils literal"><span class="pre">redirect</span></tt> function is actually a shortcut
I created to create a new <tt class="docutils literal"><span class="pre">RedirectResponse</span></tt> object.</p>
</div>
</div>
<div class="section" id="authorizing-on-coop">
<h2>Authorizing on COOP<a class="headerlink" href="authorization-code#authorizing-on-coop" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s try it! Go back to the homepage and click the &#8220;Authorize&#8221; link. This
takes us to our code, which then redirects us to COOP. We&#8217;re already logged
in, so it gets straight to asking us to authorize the app. Notice that the
scopes that we included in the URL are clearly communicated. Let&#8217;s authorize
the app. Later, we&#8217;ll see what happens if you don&#8217;t.</p>
<p>When we click the authorization button, we&#8217;re sent back to the <tt class="docutils literal"><span class="pre">redirect_uri</span></tt>
on TopCluck! Nothing has really happened yet. COOP didn&#8217;t set any cookies
or anything else. But the URL <em>does</em> include a <tt class="docutils literal"><span class="pre">code</span></tt> query parameter.</p>
</div>
<div class="section" id="exchanging-the-authorization-code-for-an-access-token">
<h2>Exchanging the Authorization Code for an Access Token<a class="headerlink" href="authorization-code#exchanging-the-authorization-code-for-an-access-token" title="Permalink to this headline">¶</a></h2>
<p>This query parameter is called the authorization code, and it&#8217;s unique
to this grant type. It&#8217;s not an access token, which is really want we want,
but it&#8217;s the key to getting that. The authorization code is our temporary
proof that the user said that our application can have an access token.</p>
<p>Let&#8217;s start by copying the code from the <tt class="docutils literal"><span class="pre">collect_eggs.php</span></tt> script and
pasting it here. Go ahead and change the <tt class="docutils literal"><span class="pre">client_id</span></tt> and <tt class="docutils literal"><span class="pre">client_secret</span></tt>
to be from the new client or application we created for TopCluck:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/OAuth2Demo/Client/Controllers/CoopOAuthController.php</span>
<span class="c1">// ...</span>

<span class="k">public</span> <span class="k">function</span> <span class="nf">receiveAuthorizationCode</span><span class="p">(</span><span class="nx">Application</span> <span class="nv">$app</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// equivalent to $_GET[&#39;code&#39;]</span>
    <span class="nv">$code</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">);</span>

    <span class="nv">$http</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">(</span><span class="s1">&#39;http://coop.apps.knpuniversity.com&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;request.options&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;exceptions&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">));</span>

    <span class="nv">$request</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/token&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;client_id&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;TopCluck&#39;</span><span class="p">,</span>
        <span class="s1">&#39;client_secret&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2e2dfd645da38940b1ff694733cc6be6&#39;</span><span class="p">,</span>
        <span class="s1">&#39;grant_type&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;authorization_code&#39;</span><span class="p">,</span>
    <span class="p">));</span>

    <span class="c1">// make a request to the token url</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
    <span class="nv">$responseBody</span> <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="nb">var_dump</span><span class="p">(</span><span class="nv">$responseBody</span><span class="p">);</span><span class="k">die</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we look back at the COOP API Authentication docs, we&#8217;ll see that <tt class="docutils literal"><span class="pre">/token</span></tt>
has 2 other parameters that are used with the authorization grant type: <tt class="docutils literal"><span class="pre">code</span></tt>
and <tt class="docutils literal"><span class="pre">redirect_uri</span></tt>. I&#8217;m already retrieving the <tt class="docutils literal"><span class="pre">code</span></tt> query parameter, so
let&#8217;s fill these in. Make sure to also change the <tt class="docutils literal"><span class="pre">grant_type</span></tt> to
<tt class="docutils literal"><span class="pre">authorization_code</span></tt> like it describes in the docs. Finally, dump the
<tt class="docutils literal"><span class="pre">$responseBody</span></tt> to see if this request works:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">receiveAuthorizationCode</span><span class="p">(</span><span class="nx">Application</span> <span class="nv">$app</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// equivalent to $_GET[&#39;code&#39;]</span>
    <span class="nv">$code</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">);</span>
    <span class="c1">// ...</span>

    <span class="nv">$request</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/token&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;client_id&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;TopCluck&#39;</span><span class="p">,</span>
        <span class="s1">&#39;client_secret&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2e2dfd645da38940b1ff694733cc6be6&#39;</span><span class="p">,</span>
        <span class="s1">&#39;grant_type&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;authorization_code&#39;</span><span class="p">,</span>
        <span class="s1">&#39;code&#39;</span>          <span class="o">=&gt;</span> <span class="nv">$code</span><span class="p">,</span>
        <span class="s1">&#39;redirect_uri&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateUrl</span><span class="p">(</span><span class="s1">&#39;coop_authorize_redirect&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="k">true</span><span class="p">),</span>
    <span class="p">));</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The key to this flow is the <tt class="docutils literal"><span class="pre">code</span></tt> parameter. When COOP receives our request,
it will check that the authorization code is valid. It also knows which user
the code belongs to, so the access token it returns will let us make API requets
on behalf of <em>that</em> user.</p>
<p>But what about the <tt class="docutils literal"><span class="pre">redirect_uri</span></tt>? This parameter is absolutely necessary
for the API request to work, but isn&#8217;t actually used by COOP. It&#8217;s a security
measure, and it <em>must</em> exactly equal the original <tt class="docutils literal"><span class="pre">redirect_uri</span></tt> that we
used when we redirected the user.</p>
<p>Ok, let&#8217;s try it! When we refresh, the API actually gives us an error:</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;invalid_grant&quot;</span><span class="p">,</span>
    <span class="nt">&quot;error_description&quot;</span><span class="p">:</span> <span class="s2">&quot;The authorization code has expired&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The authorization code has a very short lifetime, typically measured in seconds.
We normally exchange it immediately for an access token, so that&#8217;s ok! Let&#8217;s
start the whole process from the homepage again.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Usually, an OAuth server will remember that a user already authorized an
app and immediately redirect the user back to your app. COOP doesn&#8217;t do this
only to make things easier to understand.</p>
</div>
<p>This time, the API request to <tt class="docutils literal"><span class="pre">/token</span></tt> returns an <tt class="docutils literal"><span class="pre">access_token</span></tt>. Woot!
Let&#8217;s also set <tt class="docutils literal"><span class="pre">expires_in</span></tt> to a variable, which is the number of seconds
until this access token expires:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">receiveAuthorizationCode</span><span class="p">(</span><span class="nx">Application</span> <span class="nv">$app</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="nv">$request</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/token&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;client_id&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;TopCluck&#39;</span><span class="p">,</span>
        <span class="s1">&#39;client_secret&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;2e2dfd645da38940b1ff694733cc6be6&#39;</span><span class="p">,</span>
        <span class="s1">&#39;grant_type&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;authorization_code&#39;</span><span class="p">,</span>
        <span class="s1">&#39;code&#39;</span>          <span class="o">=&gt;</span> <span class="nv">$code</span><span class="p">,</span>
        <span class="s1">&#39;redirect_uri&#39;</span>  <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateUrl</span><span class="p">(</span><span class="s1">&#39;coop_authorize_redirect&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="k">true</span><span class="p">),</span>
    <span class="p">));</span>

    <span class="c1">// make a request to the token url</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
    <span class="nv">$responseBody</span> <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="nv">$responseArr</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$responseBody</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

    <span class="nv">$accessToken</span> <span class="o">=</span> <span class="nv">$responseArr</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">];</span>
    <span class="nv">$expiresIn</span> <span class="o">=</span> <span class="nv">$responseArr</span><span class="p">[</span><span class="s1">&#39;expires_in&#39;</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="using-the-access-token">
<h2>Using the Access Token<a class="headerlink" href="authorization-code#using-the-access-token" title="Permalink to this headline">¶</a></h2>
<p>Just like in our CRON script, let&#8217;s use the access token to make an API request!
One of the endpoints is <tt class="docutils literal"><span class="pre">/api/me</span></tt>, which returns information about the user
that is tied to the access token. Let&#8217;s make a GET request to this endpoint,
setting the access token on the <tt class="docutils literal"><span class="pre">Authorization</span></tt> header, just like we did
before:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">receiveAuthorizationCode</span><span class="p">(</span><span class="nx">Application</span> <span class="nv">$app</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="nv">$accessToken</span> <span class="o">=</span> <span class="nv">$responseArr</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">];</span>
    <span class="nv">$expiresIn</span> <span class="o">=</span> <span class="nv">$responseArr</span><span class="p">[</span><span class="s1">&#39;expires_in&#39;</span><span class="p">];</span>

    <span class="nv">$request</span> <span class="o">=</span> <span class="nv">$http</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/api/me&#39;</span><span class="p">);</span>
    <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">addHeader</span><span class="p">(</span><span class="s1">&#39;Authorization&#39;</span><span class="p">,</span> <span class="s1">&#39;Bearer &#39;</span><span class="o">.</span><span class="nv">$accessToken</span><span class="p">);</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
    <span class="k">echo</span> <span class="p">(</span><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getBody</span><span class="p">(</span><span class="k">true</span><span class="p">));</span><span class="k">die</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Try it by going back to the homepage and clicking &#8220;Authorize&#8221;. Simply refreshing
the page won&#8217;t work here, as the authorization code will have already expired.
With any luck, you&#8217;ll see a JSON response with information about the user:</p>
<div class="highlight-json"><div class="highlight"><pre>{
    id: &quot;2&quot;,
    email: &quot;brent@knpuniversity.com&quot;,
    firstName: &quot;Brent&quot;,
    lastName: &quot;Shaffer&quot;
}
</pre></div>
</div>
<p>This works of course because we&#8217;re sending an access token that is tied to
Brent&#8217;s account. This also works because when we redirect the user, we&#8217;re
asking for the <tt class="docutils literal"><span class="pre">profile</span></tt> scope.</p>
<p>And with that, we&#8217;ve seen the key parts of the authorization code grant type
and how to use an access token in our application. But where should we store
the token and what if the user denies our application access? We&#8217;ll look
at these next.</p>
</div>
</div>


    
                        </div>
                    </div>
                    <div class="tab-pane" id="tab-comment">
                        <h3>Leave a comment!</h3>
                                                        <div id="disqus_thread">
                <style type="text/css">
            #dsq-comments {padding: 10px 0 0}
            .dsq-comment {position: relative;clear: both;margin: 0 0 1.5em;}
            .dsq-avatar {left: 0;position: absolute;}
            .dsq-avatar img {border: 0 none;border-radius: 3px;height: 36px;width: 36px;}
            .dsq-comment-body {padding: 0 0 0 46px;}
            .dsq-comment-header {border: 1px solid rgba(0, 0, 0, 0.15);border-radius: 3px;font-size: 13px;line-height: 14px;margin: 0 0 1em;max-height: 36px;overflow: hidden;padding: 10px;position: relative;text-overflow: ellipsis;white-space: nowrap;}
            .dsq-comment-message {word-wrap: break-word;}
            .dsq-comment-message {line-height: 1.5em;margin: 0 0 1em;}
            .dsq-comment-text {display: inline;}
            .dsq-comment-date {float: right;font-size: 90%;margin: 0 12px 0 0;}
        </style>

	    <div id="dsq-content">
	        <ul id="dsq-comments">
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2540899043" id="dsq-comment-2540899043">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/loovien/">
	                            	                                <img alt="" src="http://a.disquscdn.com/1479321018/images/noavatar92.png">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2540899043">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-02-28</span>
	                            <span class="dsq-commenter-name">loovien</span>
	                        </div>

	                        <div id="dsq-comment-message-2540899043" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2540899043" class="dsq-comment-text">
	                                <p>very usefull</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2534607757" id="dsq-comment-2534607757">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/weaverryan/">
	                            	                                <img alt="" src="http://a.disquscdn.com/uploads/users/32/6480/avatar92.jpg?1482356913">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2534607757">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-02-25</span>
	                            <span class="dsq-commenter-name">weaverryan</span>
	                        </div>

	                        <div id="dsq-comment-message-2534607757" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2534607757" class="dsq-comment-text">
	                                <p>Hey Nathan! I'm glad you got it sorted out - I was just looking through your first comment when I saw you had already fixed it. Awesome! Good luck!</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2533552244" id="dsq-comment-2533552244">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/disqus_VX74AYNwJ9/">
	                            	                                <img alt="" src="http://a.disquscdn.com/1479321018/images/noavatar92.png">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2533552244">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-02-24</span>
	                            <span class="dsq-commenter-name">Nathan B.</span>
	                        </div>

	                        <div id="dsq-comment-message-2533552244" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2533552244" class="dsq-comment-text">
	                                <p>I figured out what I was doing wrong. I was using $this instead of $user when setting the coopAccessToken, coopUserId, and coopAccessExpiresAt properties. Changing the end of my code to the following worked:</p><p>/..<br>$user = $this-&gt;getLoggedInUser();<br>$user-&gt;coopAccessToken = $accessToken;<br>$user-&gt;coopUserId = $json['id'];<br>$user-&gt;coopAccessExpiresAt = $expiresAt;<br>if ($this-&gt;saveUser($user)) // This part fails and $json['id'] is not saved<br>{<br>echo $response-&gt;getBody(); die; <br>}<br>die('Save failed');</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2532915000" id="dsq-comment-2532915000">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/disqus_VX74AYNwJ9/">
	                            	                                <img alt="" src="http://a.disquscdn.com/1479321018/images/noavatar92.png">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2532915000">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2016-02-24</span>
	                            <span class="dsq-commenter-name">Nathan B.</span>
	                        </div>

	                        <div id="dsq-comment-message-2532915000" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2532915000" class="dsq-comment-text">
	                                <p>Near the end of video "Authorization Code Grant Type", I first receive the access token and then use that access token to connect to the /api/me endpoint with an "Authorization" header. I get the proper json response including my Coop user_id and then try to save to my local db which fails. I've stepped through the code with Xdebug to verify this and it appears to try and create a new user in the sqlite db instead of updating. My code is below. Thank you for your help:</p><p>/coop/start/client/src/OAuth2Demo/Client/Controllers/CoopOAuthController.php</p><p>public function receiveAuthorizationCode(Application $app, Request $request)<br>// ...</p><p>$response = $request-&gt;send();<br>$responseBody = $response-&gt;getBody(true);<br>$responseArr = json_decode($responseBody, true);<br>$accessToken = $responseArr['access_token'];<br>$expiresIn = $responseArr['expires_in'];<br>$expiresAt = new \DateTime('+' . $expiresIn . ' seconds');</p><p>$request = $http-&gt;get('/api/me');<br>$request-&gt;addHeader('Authorization', 'Bearer ' . $accessToken);<br>$response = $request-&gt;send();<br>$json = json_decode($response-&gt;getBody(), true);</p><p>$user = $this-&gt;getLoggedInUser();<br>$this-&gt;coopAccessToken = $accessToken;<br>$this-&gt;coopUserId = $json['id'];<br>$this-&gt;coopAccessExpiresAt = $expiresAt;<br>if ($this-&gt;saveUser($user)) // This part fails and $json['id'] is not saved<br>{<br>    echo $response-&gt;getBody(); die; <br>}<br>die('Save failed');</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="2412493920" id="dsq-comment-2412493920">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/i_xperts/">
	                            	                                <img alt="" src="http://a.disquscdn.com/uploads/users/15972/4821/avatar92.jpg?1433013570">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-2412493920">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2015-12-16</span>
	                            <span class="dsq-commenter-name">Simon Waldburger</span>
	                        </div>

	                        <div id="dsq-comment-message-2412493920" class="dsq-comment-message">
	                            <div id="dsq-comment-text-2412493920" class="dsq-comment-text">
	                                <p>Hey Folks thanks for this tutorial!<br>I've seen the composer get broken by version incompatibility while versions climbs higher... The easiest way around this, is to go fix the version numbers.<br>In composer.json adjust every version according to this pattern: "1.2.3"<br>So remove every "~"-sign and if the the version is composed out of two parts (major and minor), then add a third part (the build) ".0" to it. So for example you get from "~1.5" to "1.5.0".<br>Safe the file, do 'composer update' and your good to go.</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="1973599521" id="dsq-comment-1973599521">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="authorization-code">
	                            	                                <img alt="" src="http://a.disquscdn.com/1479321018/images/noavatar92.png">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-1973599521">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2015-04-18</span>
	                            <span class="dsq-commenter-name">Peter Couture</span>
	                        </div>

	                        <div id="dsq-comment-message-1973599521" class="dsq-comment-message">
	                            <div id="dsq-comment-text-1973599521" class="dsq-comment-text">
	                                <p>Thank you for the tutorial. I've been staring at the RPC spec docs for 3 weeks and my eyes were sore.</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="1815632634" id="dsq-comment-1815632634">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/nglaserpower/">
	                            	                                <img alt="" src="http://a.disquscdn.com/uploads/users/8894/3579/avatar92.jpg?1431466514">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-1815632634">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2015-01-25</span>
	                            <span class="dsq-commenter-name">nglaser power</span>
	                        </div>

	                        <div id="dsq-comment-message-1815632634" class="dsq-comment-message">
	                            <div id="dsq-comment-text-1815632634" class="dsq-comment-text">
	                                <p>If you are getting a pdodriver not found exception you may have to install sqlite and php5-sqlite.  I am running on vagrant box ubuntu 14.04.</p><p>Here are the commands if you are ubuntu flavored linux</p><p>sudo apt-get install sqlite<br>sudo apt-get install php5-sqlite</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="1812843170" id="dsq-comment-1812843170">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="https://disqus.com/by/weaverryan/">
	                            	                                <img alt="" src="http://a.disquscdn.com/uploads/users/32/6480/avatar92.jpg?1482356913">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-1812843170">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2015-01-23</span>
	                            <span class="dsq-commenter-name">weaverryan</span>
	                        </div>

	                        <div id="dsq-comment-message-1812843170" class="dsq-comment-message">
	                            <div id="dsq-comment-text-1812843170" class="dsq-comment-text">
	                                <p>Hey Saad!</p><p>Right now, the download button doesn't show up unless you own this screencast (or have the all-access pass). I want to fix that, but for now, you can also get the starting state of the project right form GitHub: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fknpuniversity%2Foauth%3ATjHr3q_6QwrJ_zX76uodAsM03uA&amp;cuid=1175718" rel="nofollow noopener">https://github.com/knpuniversi...</a></p><p>Cheers!</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	                <li class="dsq-comment dsq-clearfix" data-dsq-comment-id="1812525167" id="dsq-comment-1812525167">
	                    <div class="dsq-avatar dsq-tt">
	                        <a href="authorization-code">
	                            	                                <img alt="" src="http://a.disquscdn.com/1479321018/images/noavatar92.png">
	                            	                        </a>
	                    </div>
	                    <div class="dsq-comment-body" id="dsq-comment-body-1812525167">
	                        <div class="dsq-comment-header">
	                            <span class="dsq-comment-date">2015-01-23</span>
	                            <span class="dsq-commenter-name">Saad Khan</span>
	                        </div>

	                        <div id="dsq-comment-message-1812525167" class="dsq-comment-message">
	                            <div id="dsq-comment-text-1812525167" class="dsq-comment-text">
	                                <p>Hi,<br>I can find the download button</p>
	                            </div>
	                        </div>
	                    </div>
	                </li>
	            	        </ul>
	    </div>
            </div>

    <script type="text/javascript">
    var disqus_shortname = 'knpuniversity';
    var disqus_container_id = 'disqus_thread';var disqus_developer = 1;var disqus_identifier = 'course_video_authorization-code';var disqus_url = 'https://knpuniversity.com/screencast/oauth/authorization-code';var disqus_config = function () {};

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

                                            </div>
                    <div class="pull-left-xs pull-right-md">
                                        <a class="btn btn-success"
           href="authorization-code2#play">
            Next Chapter <i class="fa fa-caret-right"></i>
        </a>
    
                    </div>
                    <div class="pull-left addthis-module">
                        
    <div class="addthis_toolbox addthis_default_style js-analytics-addthis-wrapper addthis_32x32_style" addthis:url="http://knpuniversity.com/screencast/oauth/authorization-code" addthis:title="OAuth2 in 8 Steps">
        <a class="addthis_button_preferred_1"></a>
        <a class="addthis_button_preferred_2"></a>
        <a class="addthis_button_preferred_3"></a>
        <a class="addthis_button_preferred_4"></a>
        <a class="addthis_button_compact"></a>
        <a class="addthis_counter addthis_bubble_style"></a>
    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<footer class="footer footer-styling">
    <div class="container">
        <div class="row">
                        <div class="col-xs-7 col-sm-4">
                <div class="row">
                    <div class="col-xs-6">
                        <ul class="list-unstyled footer-link">
                            <li><a class="knp-color-black" href="../../courses/all">All Courses</a></li>
                                                            <li><a class="knp-color-black" href="../../pricing.1">Pricing</a></li>
                                                        <li><a class="knp-color-black" href="../../faq">FAQ</a></li>
                            <li><a class="knp-color-black" href="../../training">Training</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-6">
                        <ul class="list-unstyled footer-link">
                            <li><a class="knp-color-black" href="../../about">About</a></li>
                            <li><a class="knp-color-black" href="../../blog">Blog</a></li>
                            <li><a class="knp-color-black" href="../../contact">Contact Us</a></li>
                            <li>
                                <a class="knp-color-black" href="../../terms">Terms</a>
                                <span class="knp-color-black">&amp;</span>
                                <a class="knp-color-black" href="../../privacy">Privacy</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="hidden-xs col-sm-4">
                <p class="disclaimer">Symfony is a registered trademark of Fabien Potencier in the United States and/or other countries.
                This product is not endorsed or sponsored by Fabien Potencier.
                </p>
            </div>
            <div class="col-xs-5 col-sm-4">
                <div class="social-icons">
                    <a class="btn btn-social-icon btn-twitter" href="https://twitter.com/KnpUniversity">
                        <i class="fa fa-twitter"></i>
                    </a>
                    <a class="btn btn-social-icon btn-facebook" href="https://www.facebook.com/KnpLabs/">
                        <i class="fa fa-facebook"></i>
                    </a>
                    <a class="btn btn-social-icon btn-github" href="https://github.com/knpuniversity">
                        <i class="fa fa-github"></i>
                    </a>
                </div>
            </div>
                    </div>
    </div>
</footer>

<!-- JS -->
            <script>
        Core.analyticsVideoStatsUrl = '/api/analytics/video/duration';
    </script>

            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-7062980-20']);
        _gaq.push(['_trackPageview']);
    </script>
    <script>
    
    </script>
    
    <script type="text/javascript">
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
    
                <script type="text/javascript">
      (function() {
        var uv = document.createElement('script'); uv.type = 'text/javascript'; uv.async = true;
        uv.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'widget.uservoice.com/pOay2WLVabhXiEffbarO6Q.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uv, s);
      })();

      UserVoice = window.UserVoice || [];
      UserVoice.push(['showTab', 'classic_widget', {
          tab_position: 'bottom-right',
          tab_label: 'Ideas or Feedback?',
          tab_color: '#005E8E'
      }]);
    </script>
        
            
        <script type="text/javascript">
    var _sf_async_config={uid:54262,domain:"knpuniversity.com",useCanonical:true};
    (function(){
      function loadChartbeat() {
        window._sf_endpt=(new Date()).getTime();
        var e = document.createElement('script');
        e.setAttribute('language', 'javascript');
        e.setAttribute('type', 'text/javascript');
        e.setAttribute('src', '//static.chartbeat.com/js/chartbeat.js');
        document.body.appendChild(e);
      }
      var oldonload = window.onload;
      window.onload = (typeof window.onload != 'function') ?
         loadChartbeat : function() { oldonload(); loadChartbeat(); };
    })();
    </script>
    
            <script>
            (function(){
                var t,i,e,n=window,o=document,a=arguments,s="script",r=["config","track","identify","visit","push","call"],c=function(){var t,i=this;for(i._e=[],t=0;r.length>t;t++)(function(t){i[t]=function(){return i._e.push([t].concat(Array.prototype.slice.call(arguments,0))),i}})(r[t])};for(n._w=n._w||{},t=0;a.length>t;t++)n._w[a[t]]=n[a[t]]=n[a[t]]||new c;i=o.createElement(s),i.async=1,i.src="//static.woopra.com/js/w.js",e=o.getElementsByTagName(s)[0],e.parentNode.insertBefore(i,e)
            })("woopra");

            woopra.config({
                domain: 'knpuniversity.com',
                download_tracking: true,
                outgoing_tracking: true
            });

                            woopra.identify({
                    userType: 'anonymous',
                    hasSubscription: 'no'
                });
                    </script>

        <script>
            woopra.track(
            'course_view_chapter',
            {"course":"oauth","courseIsOwned":false,"chapter":"Authorization Code Grant Type","chapterNumber":3,"chapterIsFree":false}
        );
    </script>

        <script>
            woopra.track();
        </script>
     
        <script type="text/javascript">
    var _qevents = _qevents || [];

    (function() {
    var elem = document.createElement('script');
    elem.src = (document.location.protocol == "https:" ? "https://secure" : "http://edge") + ".quantserve.com/quant.js";
    elem.async = true;
    elem.type = "text/javascript";
    var scpt = document.getElementsByTagName('script')[0];
    scpt.parentNode.insertBefore(elem, scpt);
    })();

    _qevents.push({
    qacct:"p-8-SEHS37bhSQ0"
    });
    </script>

    <noscript>
    <div style="display:none;">
    <img src="http://pixel.quantserve.com/pixel/p-8-SEHS37bhSQ0.gif" border="0" height="1" width="1" alt="Quantcast"/>
    </div>
    </noscript>
    


    <script type="text/javascript" src="../../assets/vendor/jquery-sticky/jquery.sticky.js"></script>
    <script type="text/javascript" src="../../assets/vendor/zeroclipboard/dist/ZeroClipboard.min.js"></script>
    <script type="text/javascript" src="../../js/CodeBlocks.js"></script>
    <script type="text/javascript" src="../../bundles/knpuniversity/sphinx/js/underscore.js"></script>
    <script type="text/javascript" src="../../bundles/knpuniversity/sphinx/js/doctools.js"></script>

    <script>
        Core.courseTitle = 'OAuth2 in 8 Steps';
        Core.courseId = 44
        Core.courseIsOwned = false;
        Core.courseSlug = 'oauth';
                    Core.chapterTitle = 'Authorization Code Grant Type';
            Core.chapterNumber = 3;
            Core.chapterIsFree = false;
            Core.chapterSlug = 'authorization-code';
        
                var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../../',
            VERSION:     '1.0.0',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
        };

        jQuery(document).ready(function() {
            // Stick left sidebar menu
            $('.js-sticker').sticky();

            var $scriptWrapper = $('.js-script-content-wrapper');
            var codeBlocks = new Core.CodeBlocks($scriptWrapper);

            var expandList = $('.js-expand-list');

            expandList.on('click', function(){
                var target = $(this).data('target');
                var $expandArea = $('#' + target);
                $expandArea.toggleClass('expanded');

                // http://stackoverflow.com/questions/2868582/click-outside-menu-to-close-in-jquery
                $(document).one('click', function closeExpandList (e){
                    if($expandArea.has(e.target).length === 0){
                        $expandArea.removeClass('expanded');
                    } else {
                        $(document).one('click', closeExpandList);
                    }
                });
            });
        });
    </script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>



    <script type="text/javascript">
    var addthis_share = {
        templates: {
            twitter: '{{title}} - {{url}} | via @KnpUniversity'
        }
    }
</script>
<script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=weaverryan"></script>

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"b4d8035b34","applicationID":"3720092","transactionName":"MgEBMkZVXBFXBRENWwtLIgVAXV0MGQ0LFGsQCgoQUUZBC0IfOgdbEBYQA2tHWg1B","queueTime":0,"applicationTime":460,"atts":"HkYCRA5PTx8=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
